# Music API

REST API для управления музыкальными плейлистами на ASP.NET Core 8 + PostgreSQL.

## Основной функционал

- **Треки**: добавление, просмотр (с пагинацией), фильтрация по исполнителю/жанру
- **Плейлисты**: создание, добавление треков, просмотр с общей длительностью
- **Исполнители и жанры**: CRUD-операции
- **Авторизация**: JWT (личные плейлисты)
- **Случайный плейлист**: генерация случайного плейлиста на N треков (опционально)

## Используемые технологии

- .NET 8, ASP.NET Core Web API
- Entity Framework Core + миграции (PostgreSQL 14+)
- FluentValidation — валидация DTO
- AutoMapper — маппинг сущностей
- MediatR — CQRS (разделение команд и запросов)
- JWT — аутентификация и авторизация
- Swagger (Swashbuckle) — автогенерация документации
- Логирование — консоль

## Структура проекта

- `Entities/` — сущности БД (Song, Performer, Genre, Playlist, User и др.)
- `DTOs/` — объекты передачи данных
- `Validators/` — FluentValidation для DTO
- `Mappings/` — AutoMapper профили
- `Services/` — бизнес-логика (по сущностям)
- `Controllers/` — REST API контроллеры
- `Migrations/` — миграции EF Core
- `ExceptionHandlers/` — централизованные обработчики ошибок

## Быстрый старт

1. **Настройте строку подключения к PostgreSQL**  
   В файле `appsettings.json`:
   ```json
   "ConnectionStrings": {
     "DefaultConnection": "Host=localhost;Port=5432;Database=musicdb;Username=postgres;Password=yourpassword"
   }
   ```
2. **Примените миграции**
   ```
   dotnet ef database update
   ```
3. **Запустите проект**
   ```
   dotnet run
   ```
4. **Документация API**
   Swagger UI: http://localhost:5000/swagger (или ваш порт)

## Примеры эндпоинтов

- `GET /api/songs?page=1&pageSize=20` — список треков с пагинацией
- `POST /api/playlists` — создать плейлист
- `POST /api/playlists/{playlistId}/songs` — добавить трек в плейлист
- `GET /api/playlists/{id}` — получить плейлист с треками и длительностью

## Валидация и обработка ошибок

- Входные данные валидируются через FluentValidation
- В случае ошибок возвращается стандартизированное сообщение и HTTP статус
- Все исключения обрабатываются централизованно

## Принципы проектирования

- Чистая архитектура: бизнес-логика вынесена в сервисы
- SOLID, DRY, KISS, YAGNI
- Понятные имена классов, методов и переменных

## Расширения

- Кэширование (по необходимости)
- Генерация случайного плейлиста
- Фильтрация по исполнителю/жанру
- Приватные плейлисты для авторизованных пользователей

---

Если возникнут вопросы или потребуется расширить документацию — смело обращайтесь!
